

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyts.specModels.wf &mdash; PyTurbSim 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="PyTurbSim 1.0 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">PyTurbSim 1.0 documentation</a> &raquo;</li>
          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pyts.specModels.wf</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">nwtc</span> <span class="kn">import</span> <span class="o">*</span>
    
<div class="viewcode-block" id="inf_turb"><a class="viewcode-back" href="../../../api/pyts.specModels.html#pyts.specModels.wf.inf_turb">[docs]</a><span class="k">class</span> <span class="nc">inf_turb</span><span class="p">(</span><span class="n">NWTCgenModel</span><span class="p">):</span>
    <span class="n">_coefs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;stable&#39;</span><span class="p">:{},</span><span class="s">&#39;unstable&#39;</span><span class="p">:{}}</span>
    <span class="n">_coefs</span><span class="p">[</span><span class="s">&#39;stable&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="c"># Low Freq !MUST BE FIRST.</span>
            <span class="p">[</span><span class="c">#P coefs</span>
                <span class="p">[</span> <span class="mf">0.88418</span><span class="p">,</span> <span class="mf">11.665367</span><span class="p">,</span> <span class="mf">0.794753</span><span class="p">,</span> <span class="mf">1.55288</span><span class="p">,</span> <span class="mf">1.56925</span><span class="p">,</span>   <span class="mf">1.50</span> <span class="p">],</span><span class="c">#u</span>
                <span class="p">[</span> <span class="mf">0.4671733</span><span class="p">,</span> <span class="mf">4.3093084</span><span class="p">,</span> <span class="mf">0.859202</span><span class="p">,</span> <span class="mf">0.90382</span><span class="p">,</span> <span class="mf">1.59076</span><span class="p">,</span> <span class="mf">0.75</span> <span class="p">],</span><span class="c">#v</span>
                <span class="p">[</span> <span class="mf">0.076136</span><span class="p">,</span> <span class="mf">2.644456</span><span class="p">,</span> <span class="mf">1.207014</span><span class="p">,</span> <span class="mf">0.533202</span><span class="p">,</span> <span class="mf">1.51415</span><span class="p">,</span>  <span class="mf">1.0</span>  <span class="p">]],</span><span class="c">#w</span>
            <span class="p">[</span><span class="c">#f coefs</span>
                <span class="p">[</span> <span class="mf">0.009709</span><span class="p">,</span> <span class="mf">0.4266236</span><span class="p">,</span> <span class="mf">1.644925</span><span class="p">,</span> <span class="mf">0.045</span><span class="p">,</span> <span class="mf">0.212038</span><span class="p">,</span> <span class="mf">2.00</span>  <span class="p">],</span>
                <span class="p">[</span> <span class="mf">0.0220509</span><span class="p">,</span> <span class="mf">0.93256713</span><span class="p">,</span> <span class="mf">1.719292</span><span class="p">,</span> <span class="mf">0.160</span><span class="p">,</span> <span class="mf">0.74985</span><span class="p">,</span> <span class="mf">1.15</span> <span class="p">],</span>
                <span class="p">[</span> <span class="mf">0.0351474</span><span class="p">,</span> <span class="mf">1.4410838</span><span class="p">,</span> <span class="mf">1.833043</span><span class="p">,</span> <span class="mf">0.350</span><span class="p">,</span> <span class="mf">1.645667</span><span class="p">,</span> <span class="mf">1.0</span>  <span class="p">]]],</span>
        <span class="p">[</span> <span class="c"># High Freq</span>
            <span class="p">[</span><span class="c">#P coefs</span>
                <span class="p">[</span> <span class="mf">0.8029768</span><span class="p">,</span> <span class="mf">1.708247</span><span class="p">,</span> <span class="mf">3.669245</span><span class="p">,</span> <span class="mf">1.5431</span><span class="p">,</span> <span class="mf">1.6379</span><span class="p">,</span> <span class="mf">0.01</span>   <span class="p">],</span>
                <span class="p">[</span> <span class="mf">0.419234</span> <span class="p">,</span> <span class="mf">2.759119</span><span class="p">,</span> <span class="mf">1.4483715</span><span class="p">,</span> <span class="mf">0.89717</span><span class="p">,</span> <span class="mf">1.67034</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">],</span>
                <span class="p">[</span> <span class="mf">0.239692</span> <span class="p">,</span> <span class="mf">2.3531204</span><span class="p">,</span> <span class="mf">1.062937</span><span class="p">,</span> <span class="mf">0.5324</span><span class="p">,</span> <span class="mf">1.6314</span><span class="p">,</span> <span class="mf">1.5</span>   <span class="p">]],</span>
            <span class="p">[</span><span class="c">#f coefs</span>
                <span class="p">[</span> <span class="mf">0.042393</span><span class="p">,</span> <span class="mf">1.28175</span><span class="p">,</span> <span class="mf">1.409066</span><span class="p">,</span> <span class="mf">0.045</span><span class="p">,</span> <span class="mf">0.21137</span><span class="p">,</span> <span class="mf">3.5</span>      <span class="p">],</span>
                <span class="p">[</span> <span class="mf">0.220831</span><span class="p">,</span> <span class="mf">0.630632</span><span class="p">,</span> <span class="mf">0.8120686</span><span class="p">,</span> <span class="mf">0.160</span><span class="p">,</span> <span class="mf">0.74876</span><span class="p">,</span> <span class="mf">1.25</span>   <span class="p">],</span>
                <span class="p">[</span> <span class="mf">0.382558</span><span class="p">,</span> <span class="mf">1.3640485</span><span class="p">,</span> <span class="mf">1.524565</span><span class="p">,</span> <span class="mf">0.350</span><span class="p">,</span> <span class="mf">1.638806</span><span class="p">,</span> <span class="mf">1.5</span>   <span class="p">]]],</span>
        <span class="p">]),</span><span class="mi">2</span><span class="p">)</span> <span class="c"># The dims of this (after the rollaxis) are (uvw,low/high,P/f,...)</span>
    
<div class="viewcode-block" id="inf_turb.initCoefs"><a class="viewcode-back" href="../../../api/pyts.specModels.html#pyts.specModels.wf.inf_turb.initCoefs">[docs]</a>    <span class="k">def</span> <span class="nf">initCoefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_loc_zL</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zL</span><span class="p">,</span><span class="mf">0.15</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_loc_zL</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zL</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span>
        <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_loc_zL</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable</span><span class="p">:</span>
            <span class="n">dat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_coefs</span><span class="p">[</span><span class="s">&#39;stable&#39;</span><span class="p">]</span>
            <span class="n">num</span><span class="o">=</span><span class="n">dat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="n">dat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">den</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
            <span class="n">den</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="n">dat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
            <span class="n">den</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="n">dat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">dat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">x</span>
            <span class="n">out</span><span class="o">=</span><span class="n">num</span><span class="o">/</span><span class="n">den</span>
            <span class="c"># An exception for the w-comp. low-freq, P-val:</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-=</span><span class="mf">1.75</span><span class="o">*</span><span class="n">x</span>
            <span class="c"># An exception for the w-comp. high-freq, P-val:</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-=</span><span class="mf">2.</span><span class="o">*</span><span class="n">x</span>
            <span class="k">if</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span>
            <span class="c"># An exception for the u-comp. low-freq, f-val:</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">3.</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
            <span class="n">out</span><span class="o">*=</span><span class="n">dat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_coefs</span><span class="p">[</span><span class="s">&#39;unstable&#39;</span><span class="p">]</span>
            <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_comp</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">ts_float</span><span class="p">)</span>

            <span class="n">zi_uvlimit</span><span class="o">=</span><span class="mi">1350</span>
            <span class="n">zi_wlimit</span><span class="o">=</span><span class="mi">1600</span>
            <span class="c"># What an unbelievable mess!!!</span>
            <span class="c"># The functions are all different, so using _coefs is too much of a pain!</span>
            <span class="c">#### Low Frequency</span>
            <span class="c"># p-coefs</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.00</span> <span class="o">*</span> <span class="p">(</span> <span class="o">-</span><span class="mf">0.436922</span>  <span class="o">+</span> <span class="mf">2.784789</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.104094</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.136708</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>  <span class="mf">0.1392684</span> <span class="o">+</span> <span class="mf">1.7396251</span><span class="o">*</span><span class="n">x</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.467006</span>  <span class="o">+</span> <span class="p">(</span><span class="mf">5.3032075</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mf">1.1713260</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.1425146</span> <span class="o">+</span> <span class="mf">2.2011562</span><span class="o">*</span><span class="n">x</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">0.086908</span>   <span class="o">+</span> <span class="p">(</span><span class="mf">2.3719755</span> <span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mf">1.3106297</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.00251981</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.50642167</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mf">0.6607754</span> <span class="p">)</span>
            <span class="c"># f-coefs</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">0.467962</span> <span class="o">+</span> <span class="mf">0.9270681</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.02039003</span> <span class="p">))</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.759259</span> <span class="o">-</span> <span class="mf">0.1448362</span><span class="o">*</span><span class="n">x</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.25</span> <span class="o">*</span> <span class="p">((</span> <span class="mf">0.369625</span> <span class="o">+</span> <span class="mf">1.0772852</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.0210098</span> <span class="p">)))</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.759259</span> <span class="o">-</span> <span class="mf">0.1448362</span><span class="o">*</span><span class="n">x</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.25</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">3.39482</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="mf">0.279914</span><span class="o">*</span><span class="n">x</span> <span class="p">))</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">4.59769</span> <span class="o">+</span> <span class="mf">12.58881</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.03351852</span> <span class="p">)</span> <span class="p">)</span>
            <span class="c">#### High Frequency</span>
            <span class="c">#P-coefs</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.10</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.691114</span>  <span class="o">+</span> <span class="mf">0.0791666</span><span class="o">*</span><span class="n">x</span>    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.77991</span>   <span class="o">+</span> <span class="mf">0.1761624</span>  <span class="o">/</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.0405364</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.0184402</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>  <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">0.421958</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="mf">0.20739895</span><span class="o">*</span><span class="n">x</span> <span class="p">))</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.5247865</span> <span class="o">+</span> <span class="mf">0.0419204</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.0434172</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.0179269</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.80</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.222875</span>  <span class="o">+</span> <span class="mf">0.1347188</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.3542331</span> <span class="o">+</span> <span class="mf">0.0168806</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.0388899</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.0220998</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="c">#f-coefs</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.75</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.047465</span>  <span class="o">+</span> <span class="mf">0.0132692</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.0599494</span> <span class="o">-</span> <span class="mf">0.0139033</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.02603846</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.50</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.18377384</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="mf">0.2995136</span><span class="o">*</span><span class="n">x</span> <span class="p">))</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.1581509</span>  <span class="o">+</span> <span class="mf">0.09501906</span><span class="o">*</span><span class="n">x</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.3419874</span> <span class="o">+</span> <span class="mf">0.24985029</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.02619489</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.451295</span>  <span class="o">+</span> <span class="mf">0.2355227</span><span class="o">*</span><span class="n">x</span> <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">&gt;</span> <span class="n">zi_uvlimit</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">/</span> <span class="n">zi_uvlimit</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*=</span><span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">/</span> <span class="n">zi_uvlimit</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">/</span> <span class="n">zi_uvlimit</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*=</span><span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">/</span> <span class="n">zi_uvlimit</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">&gt;</span> <span class="n">zi_wlimit</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*=</span><span class="mf">4.0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">/</span> <span class="n">zi_wlimit</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*=</span> <span class="mf">0.35</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">/</span> <span class="n">zi_wlimit</span>
        <span class="n">out</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**=-</span><span class="mi">1</span> <span class="c"># Invert the second (fr) coefficient.</span>
        <span class="n">out</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*=</span><span class="n">out</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="c"># All of the first coefficients are the product of the first and the second (inverse included).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefs</span><span class="o">=</span><span class="n">out</span>

    <span class="c">## def _beta4(self,x,a):</span>
    <span class="c">##     return a[0]*np.exp(-x/a[1])+a[2]*np.exp(-x/a[3])</span>
    <span class="c">## def _beta5(self,x,a):</span>
    <span class="c">##     return a[0]/(1.0+np.exp((a[1]-x)/a[2]))</span>
</div></div>
<div class="viewcode-block" id="outf_turb"><a class="viewcode-back" href="../../../api/pyts.specModels.html#pyts.specModels.wf.outf_turb">[docs]</a><span class="k">class</span> <span class="nc">outf_turb</span><span class="p">(</span><span class="n">NWTCgenModel</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_beta1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
        <span class="n">tmp1</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tmp2</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">tmp1</span><span class="o">+</span><span class="n">tmp2</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">tmp1</span><span class="o">-</span><span class="n">tmp2</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span>

    <span class="k">def</span> <span class="nf">_beta2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">2.50663</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_beta3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta10</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mf">1.414</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>

<div class="viewcode-block" id="outf_turb.initCoefs"><a class="viewcode-back" href="../../../api/pyts.specModels.html#pyts.specModels.wf.outf_turb.initCoefs">[docs]</a>    <span class="k">def</span> <span class="nf">initCoefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loc_zL</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fix2range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zL</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.4</span><span class="p">))</span>
        <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_loc_zL</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable</span><span class="p">:</span>
            <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_comp</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">ts_float</span><span class="p">)</span>
            <span class="c">### Low Freq.</span>
            <span class="c">#P-vals</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.894383</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.55915</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mf">3.111778</span><span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="mf">1.563317</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.137965</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.60</span> <span class="o">*</span> <span class="p">((</span> <span class="mf">0.747514</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.57011</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mf">1.681581</span><span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="mf">0.910783</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.1523931</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.75</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="p">((</span> <span class="mf">0.376008</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.4807733</span><span class="o">*</span> <span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span> <span class="mf">0.539112</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.124104</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
            <span class="c">#f-vals</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="p">((</span> <span class="mf">0.023450</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.3088194</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mf">1.24710</span><span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="mf">0.045</span>    <span class="o">+</span>  <span class="mf">0.209305</span>  <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">),</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.051616</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.8950263</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mf">1.37514</span><span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="mf">0.160</span>    <span class="o">+</span>  <span class="mf">0.749661</span>  <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span><span class="p">(</span> <span class="mf">0.250375</span> <span class="o">-</span> <span class="mf">0.690491</span>  <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">2.4329342</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="mf">0.350</span>    <span class="o">+</span> <span class="mf">1.6431833</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
            <span class="c">### High Freq.</span>
            <span class="c">#P-vals</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.35</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.149471</span> <span class="o">+</span> <span class="mf">0.028528</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.003580</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.0018863</span> <span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.0035802</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.0018863</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span> <span class="mf">1.563166</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.137965</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.25</span> <span class="o">*</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span> <span class="mf">2.66666062</span><span class="p">,</span> <span class="mf">0.0034082</span><span class="p">,</span> <span class="mf">0.0229827</span><span class="p">,])</span><span class="o">+</span><span class="n">beta1</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span> <span class="mf">33.942268</span><span class="p">,</span>  <span class="mf">0.0160732</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.008654</span><span class="p">,</span>  <span class="mf">0.0053586</span><span class="p">]))</span><span class="o">*</span><span class="mf">0.9170783</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.152393</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span><span class="o">**-</span><span class="mi">1</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.9</span>  <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span> <span class="mf">0.1990569</span><span class="p">,</span> <span class="mf">0.0286048</span><span class="p">,</span> <span class="mf">0.006751</span><span class="p">,])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta2</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span> <span class="mf">0.0435354</span><span class="p">,</span> <span class="mf">0.0599214</span><span class="p">,</span> <span class="mf">0.0520877</span><span class="p">,]))</span><span class="o">/</span><span class="p">(</span><span class="mf">0.539112</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.124104</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
            <span class="c">#f-vals</span>
            <span class="n">tmp</span>    <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.037003738</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.01612278</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.764910145</span> <span class="o">+</span> <span class="mf">0.654370025</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmp</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">0.045</span> <span class="o">+</span> <span class="mf">0.209305</span>  <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beta3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span> <span class="mf">0.5491507</span><span class="p">,</span> <span class="mf">0.0099211</span><span class="p">,</span> <span class="mf">0.0044011</span><span class="p">,])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beta2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span> <span class="mf">0.0244484</span><span class="p">,</span> <span class="mf">0.0139515</span><span class="p">,</span> <span class="mf">0.0109543</span><span class="p">,]))</span><span class="o">/</span><span class="p">(</span><span class="mf">0.160</span> <span class="o">+</span> <span class="mf">0.7496606</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.391962642</span> <span class="o">+</span> <span class="mf">0.546722344</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.023188588</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.018447575</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span> <span class="mf">0.350</span> <span class="o">+</span> <span class="mf">1.6431833</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_comp</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">ts_float</span><span class="p">)</span> <span class="c"># An extra term for the wake. u,w will be NaN</span>
            <span class="c">### Low Freq.</span>
            <span class="c"># P-vals</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.796264</span> <span class="o">+</span> <span class="mf">0.316895</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.082483</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.027480</span> <span class="p">))</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.07616</span>  <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.303919</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">0.390906</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">&lt;</span> <span class="mf">1600.0</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">/</span> <span class="mf">1600.0</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>  <span class="p">(</span> <span class="mf">0.812483</span> <span class="o">+</span> <span class="mf">0.1332134</span> <span class="o">*</span> <span class="n">x</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.104132</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.714674</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">0.495370</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ZI</span><span class="o">/</span><span class="mi">1600</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.371298</span>  <span class="o">+</span> <span class="mf">0.0425447</span> <span class="o">*</span> <span class="n">x</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.0004375</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.4145751</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">0.6091557</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="c"># f-vals</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.859809</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.157999</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.81459</span> <span class="o">+</span> <span class="mf">0.021942</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">&gt;</span> <span class="mf">1850.0</span><span class="p">):</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*=</span><span class="mf">2.6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">/</span> <span class="mf">1850.0</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.8121775</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">4.122E+15</span> <span class="p">)</span> <span class="o">-</span> <span class="mf">0.594909</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.0559581</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.72535</span>  <span class="o">-</span> <span class="mf">0.0256291</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ZI</span><span class="o">/</span><span class="mi">1600</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">6.05669</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.97418</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">3.418386</span> <span class="o">+</span> <span class="mf">9.58012</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.0480283</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.022657</span><span class="p">)</span> <span class="p">)))</span> <span class="p">)</span>
            <span class="c">### High Freq.</span>
            <span class="c"># P-vals</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.598894</span>  <span class="o">+</span> <span class="mf">0.282106</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.0594047</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.600977</span>  <span class="o">+</span> <span class="mf">9.137681</span>  <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.830756</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.252026</span><span class="p">)</span> <span class="p">)))</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.4830249</span> <span class="o">+</span> <span class="mf">0.3703596</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.0553952</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.464604</span>  <span class="o">+</span> <span class="mf">1.900294</span>  <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.928719</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.317242</span><span class="p">)</span> <span class="p">)))</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.25</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.320112</span>  <span class="o">+</span> <span class="mf">0.229540</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.0126555</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.331887</span>  <span class="o">+</span> <span class="mf">1.933535</span>  <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.19018</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.3011064</span><span class="p">)</span> <span class="p">)))</span> <span class="p">)</span>
            <span class="c"># f-vals</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.3</span> <span class="o">*</span> <span class="p">(</span>  <span class="p">(</span> <span class="mf">0.049279</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.245214</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">2.478923</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.333556</span> <span class="o">+</span> <span class="mf">2.4111804</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.623439</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.1438076</span><span class="p">)))</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span>  <span class="p">(</span><span class="o">-</span><span class="mf">2.94362</span>   <span class="o">+</span> <span class="mf">3.155970</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.872698</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.245246</span><span class="p">))</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.0171463</span> <span class="o">+</span> <span class="mf">0.188081</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.711851</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.688910</span><span class="p">)))</span> <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.75</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.7697576</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">3.8408779</span> <span class="p">)</span> <span class="o">-</span> <span class="mf">0.561527</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.1684403</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.512356</span>  <span class="o">-</span> <span class="mf">0.044946</span>  <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.066061</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.0121168</span><span class="p">)</span> <span class="p">)))</span> <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZI</span> <span class="o">&lt;</span> <span class="mf">1350.0</span> <span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*=</span> <span class="n">ZI</span> <span class="o">/</span> <span class="mf">1350.0</span>
            <span class="c">### Wake term, v-component only</span>
            <span class="c"># P-vals</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.247754</span> <span class="o">+</span> <span class="mf">0.16703142</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="mf">0.1172513</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.464604</span> <span class="o">+</span> <span class="mf">1.900294</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.928719</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.317242</span><span class="p">)</span> <span class="p">)))</span> <span class="p">)</span>
            <span class="c"># f-vals</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">0.72435</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.0436448</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.08527</span> <span class="p">))</span>  <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">0.0171463</span> <span class="o">+</span> <span class="mf">0.188081</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.711851</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.688910</span><span class="p">)))</span> <span class="p">)</span>
        <span class="n">out</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**=-</span><span class="mi">1</span> <span class="c"># Invert the second (fr) coefficient.</span>
        <span class="n">out</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*=</span><span class="n">out</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="c"># All of the first coefficients are the product of the first and the second (inverse included).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefs</span><span class="o">=</span><span class="n">out</span>
            </div></div>
<div class="viewcode-block" id="gp_llj"><a class="viewcode-back" href="../../../api/pyts.specModels.html#pyts.specModels.wf.gp_llj">[docs]</a><span class="k">class</span> <span class="nc">gp_llj</span><span class="p">(</span><span class="n">NWTCgenModel</span><span class="p">):</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_loc_zL</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;_val_loc_zL&#39;</span><span class="p">):</span>
            <span class="n">zlims</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">140</span><span class="p">]</span>
            <span class="n">z</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">z</span>
            <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">ilow</span><span class="o">=</span><span class="n">z</span><span class="o">&lt;</span><span class="n">zlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ihgh</span><span class="o">=</span><span class="n">z</span><span class="o">&gt;</span><span class="n">zlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">out</span><span class="p">[</span><span class="n">ilow</span><span class="p">]</span><span class="o">=</span><span class="n">z</span><span class="p">[</span><span class="n">ilow</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span>
            <span class="n">out</span><span class="p">[</span><span class="n">ihgh</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zL</span>
            <span class="c">#if !!!CHECKTHIS... I&#39;m not done here.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_val_loc_zL</span>

<div class="viewcode-block" id="gp_llj.initCoefs"><a class="viewcode-back" href="../../../api/pyts.specModels.html#pyts.specModels.wf.gp_llj.initCoefs">[docs]</a>    <span class="k">def</span> <span class="nf">initCoefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loc_ustar</span><span class="o">=</span><span class="n">fix2range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&#39;UStar&#39;</span><span class="p">],</span><span class="o">.</span><span class="mi">15</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loc_zL2</span><span class="o">=</span><span class="n">fix2range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_loc_zL</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
        <span class="c"># !!!VERSION_INCONSISTENCY: there is some funny business here about</span>
        <span class="c"># z/L and u* profiles, as opposed to &#39;mean&#39; values (see doc).  I don&#39;t understand</span>
        <span class="c"># how this is implemented, so I will proceed the same as in the above</span>
        <span class="c"># models for now...</span>
        <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">ts_float</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stable</span><span class="p">:</span>
            <span class="n">zl_loc</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_loc_zL</span><span class="p">,</span><span class="mf">0.025</span><span class="p">)</span> <span class="c"># Can&#39;t combine this with the fix2range above</span>
                                      <span class="c"># because phiM and phiE depend on self.zL</span>
            <span class="n">ustar_loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ustar</span>
            <span class="c">### Low Freq.</span>
            <span class="c"># P-val</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.003043</span><span class="o">*</span><span class="p">(</span>  <span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.60526081</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.4348077</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="mf">1.386013230</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">+</span><span class="mf">2.185372290</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0222952</span><span class="o">*</span><span class="p">(</span> <span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span> <span class="mf">0.18448738</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.23473414</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.216594402</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">+</span><span class="mf">1.491864128</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.</span>
            <span class="c"># f-val</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.014746</span><span class="o">*</span><span class="p">(</span>  <span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.37495232</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6167086</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.994591040</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">+</span><span class="mf">1.676298830</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.0008437</span><span class="o">*</span><span class="p">(</span> <span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.79592929</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.78297586</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="mf">1.316511335</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">+</span><span class="mf">0.175154746</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.</span>
            <span class="c">### High Freq.</span>
            <span class="c"># P-val</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">15.468066</span><span class="o">*</span><span class="p">(</span>  <span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span> <span class="mf">0.27375765</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span> <span class="mf">1.8091998</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.266223760</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">-</span><span class="mf">3.091731900</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.6568440</span><span class="o">*</span><span class="p">(</span> <span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03919916</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span> <span class="mf">0.57537263</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">+</span><span class="mf">0.282805584</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">-</span><span class="mf">1.199845489</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.69547455</span><span class="o">*</span><span class="p">(</span><span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.00800265</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1352012</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="mf">0.041784840</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">-</span><span class="mf">0.003785870</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
            <span class="c"># f-val</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.043108</span><span class="o">*</span><span class="p">(</span>  <span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.39311528</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.1719048</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="mf">0.152732100</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">+</span><span class="mf">2.939119120</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5278523</span><span class="o">*</span><span class="p">(</span> <span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.14197939</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span> <span class="mf">0.02684469</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.261902952</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">-</span><span class="mf">0.672772974</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">0.97627403</span><span class="o">*</span><span class="p">(</span><span class="n">zl_loc</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05470045</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ustar_loc</span><span class="o">**</span><span class="p">(</span><span class="mf">0.09666427</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.301255210</span><span class="o">*</span><span class="n">zl_loc</span><span class="o">-</span><span class="mf">0.063122900</span><span class="o">*</span><span class="n">ustar_loc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span> <span class="c"># The unstable coefficients are simply ones.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefs</span><span class="o">=</span><span class="n">out</span>
        </div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">PyTurbSim 1.0 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Levi Kilcher.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>